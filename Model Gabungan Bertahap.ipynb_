{"cells":[{"cell_type":"markdown","metadata":{"id":"lOVqetaz6zI6"},"source":["# Pembangunan Model Gabungan Langsung - Sistem Pengenal Emosi Cakapan"]},{"cell_type":"markdown","metadata":{"id":"WHO9uPMk65Yz"},"source":["## Library Preparation"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7120,"status":"ok","timestamp":1622634439264,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"sd_kr8StfNrB","outputId":"62546ff3-965d-4074-fa34-918a1ed6252a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting arff\n","  Downloading https://files.pythonhosted.org/packages/50/de/62d4446c5a6e459052c2f2d9490c370ddb6abc0766547b4cef585913598d/arff-0.9.tar.gz\n","Building wheels for collected packages: arff\n","  Building wheel for arff (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for arff: filename=arff-0.9-cp37-none-any.whl size=4970 sha256=1c91679950193d193da4549a175cdea7c8af8927aade2fba34910202f0edc997\n","  Stored in directory: /root/.cache/pip/wheels/04/d0/70/2c73afedd3ac25c6085b528742c69b9587cbdfa67e5194583b\n","Successfully built arff\n","Installing collected packages: arff\n","Successfully installed arff-0.9\n","Requirement already satisfied: imbalanced-learn in /usr/local/lib/python3.7/dist-packages (0.4.3)\n","Requirement already satisfied: numpy\u003e=1.8.2 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn) (1.19.5)\n","Requirement already satisfied: scikit-learn\u003e=0.20 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn) (0.22.2.post1)\n","Requirement already satisfied: scipy\u003e=0.13.3 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn) (1.4.1)\n","Requirement already satisfied: joblib\u003e=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn\u003e=0.20-\u003eimbalanced-learn) (1.0.1)\n"]}],"source":["!pip install arff\n","!pip install imbalanced-learn"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2484,"status":"ok","timestamp":1622634441739,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"MBC7-oK4bUPM","outputId":"626cf0dc-f9e0-4f34-be43-45551fba833b"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/externals/six.py:31: FutureWarning: The module is deprecated in version 0.21 and will be removed in version 0.23 since we've dropped support for Python 2.7. Please rely on the official version of six (https://pypi.org/project/six/).\n","  \"(https://pypi.org/project/six/).\", FutureWarning)\n","/usr/local/lib/python3.7/dist-packages/sklearn/utils/deprecation.py:144: FutureWarning: The sklearn.neighbors.base module is  deprecated in version 0.22 and will be removed in version 0.24. The corresponding classes / functions should instead be imported from sklearn.neighbors. Anything that cannot be imported from sklearn.neighbors is now part of the private API.\n","  warnings.warn(message, FutureWarning)\n"]}],"source":["import arff\n","import joblib\n","from io import StringIO\n","from google.colab import drive\n","from google.colab import files\n","\n","import pandas as pd\n","import numpy as np\n","import tensorflow as tf\n","from tensorflow import keras\n","from tensorflow.keras import layers\n","from imblearn.over_sampling import SMOTE\n","from sklearn.model_selection import train_test_split\n","from sklearn.preprocessing import OneHotEncoder\n","from keras.models import Sequential\n","from keras import backend\n","from keras import layers\n","from sklearn.metrics import classification_report, confusion_matrix\n","from sklearn.model_selection import KFold\n","from sklearn.model_selection import StratifiedShuffleSplit\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from keras.callbacks import EarlyStopping\n","from sklearn.preprocessing import MinMaxScaler"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":32205,"status":"ok","timestamp":1622634473934,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"qtvx_zf-cMwY","outputId":"3ff7be46-201e-463d-d7c1-41fa3f21d8d9"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/gdrive\n"]}],"source":["drive.mount('/content/gdrive')\n","drive_dir = \"/content/gdrive/MyDrive/Teknik Informatika/Semester 7/TUGAS AKHIR/TA 2\""]},{"cell_type":"markdown","metadata":{"id":"S2OerLT9mfrB"},"source":["## Load Data"]},{"cell_type":"markdown","metadata":{"id":"zbtGKWA6gi8q"},"source":["### Audio"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":21,"status":"ok","timestamp":1622634473937,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"_2aobu05fiiu"},"outputs":[],"source":["def read_arff_data(data):\n","  row = next(data)\n","  row = next(data)\n","  list_data = []\n","  i = 0\n","  while row:\n","    # if (i % 100 == 0):\n","    #   print('Reading...', i, 'data already done.')\n","    row_data = []\n","    for j in range(len(row)):\n","      if (j != 0 and row[j] != ''):\n","        row_data.append(row[j])\n","    list_data.append(row_data)\n","    try :\n","      row = next(data)\n","      i = i + 1\n","    except :\n","      break\n","  return np.array(list_data)"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2246,"status":"ok","timestamp":1622634476169,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"mU1b9PrKfjRn","outputId":"8274bb76-07eb-4fde-a92c-3cd2869c907a"},"outputs":[{"data":{"text/plain":["(10822, 88)"]},"execution_count":5,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["feature_akustik = read_arff_data(arff.load(drive_dir + '/Eksperimen/Data/eGeMAPS.arff'))\n","feature_akustik.shape"]},{"cell_type":"markdown","metadata":{"id":"CgrKRHu5hLa_"},"source":["### Textual"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1013,"status":"ok","timestamp":1622634477170,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"7I7xDSv-f7Mc","outputId":"fd520b86-de06-4460-8678-48fe95933de0"},"outputs":[{"data":{"text/plain":["(10822, 5017)"]},"execution_count":6,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["data = joblib.load(drive_dir + '/Eksperimen/Data/stopword.pkl')\n","tfidf_vectorizer = TfidfVectorizer()\n","feature_tfidf = tfidf_vectorizer.fit_transform(data['Transkripsi'])\n","feature_leksikal = np.array(feature_tfidf.todense())\n","feature_leksikal.shape"]},{"cell_type":"markdown","metadata":{"id":"QjAS_5MU_2y9"},"source":["## Prepare Data Pemodelan"]},{"cell_type":"markdown","metadata":{"id":"YlcHCKQyklWJ"},"source":["### Scaling Data Akustik"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1622634477172,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"uOPCEEHqkndm","outputId":"2fb8eeaa-f064-49c5-d28a-0417483940f5"},"outputs":[{"data":{"text/plain":["(10822, 88)"]},"execution_count":7,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scaler = MinMaxScaler()\n","feature_akustik = scaler.fit_transform(feature_akustik)\n","feature_akustik.shape"]},{"cell_type":"markdown","metadata":{"id":"aIc_Wk83lIkK"},"source":["### Construct Concatenate Features"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1622634477173,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"Uj7YFUGhlLML"},"outputs":[],"source":["def concat_features(feature_1, feature_2):\n","  features = []\n","  for i in range(len(feature_1)):\n","    temp = []\n","    temp.extend(feature_1[i])\n","    temp.extend(feature_2[i])\n","    features.append(temp)\n","  return np.array(features, dtype=object)"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6388,"status":"ok","timestamp":1622634483552,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"kYEMEU_slQep","outputId":"c11a9da2-b00f-4150-a385-a120869aacda"},"outputs":[{"data":{"text/plain":["(10822, 5105)"]},"execution_count":9,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["feature_concat = concat_features(feature_leksikal, feature_akustik)\n","feature_concat.shape"]},{"cell_type":"markdown","metadata":{"id":"cDB12w9tAlCn"},"source":["### Construct Sequential Data "]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":53,"status":"ok","timestamp":1622634483554,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"okJFZv65AwvY"},"outputs":[],"source":["def construct_sequential(id, data):\n","  sequential_datas = []\n","  new_data= []\n","  for i in range(len(id)):\n","    if id[i].endswith('001'):\n","      sequential_datas.append(new_data)\n","      new_data = []\n","    new_data.append(data[i])\n","  sequential_datas.append(new_data)\n","\n","  return np.array(sequential_datas, dtype=object)[1:]"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":51,"status":"ok","timestamp":1622634483555,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"sM0CRCMg515_"},"outputs":[],"source":["def construct_abstract(id, abstraksi):\n","  new_abstraksi = []\n","  for i in range(len(id)):\n","    if id[i].endswith('001'):\n","      new_abstraksi.append(abstraksi[i])\n","\n","  return np.array(new_abstraksi, dtype=object)"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":50,"status":"ok","timestamp":1622634483556,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"Z00egS7q_6au","outputId":"d2a09ea9-780c-4e52-c5ba-cb7626258a62"},"outputs":[{"name":"stdout","output_type":"stream","text":["(2003,) (2003,) (2003,)\n"]}],"source":["id = data['ID Ucapan']\n","sequential_features_akustik, sequential_features_leksikal, sequential_features_concat = construct_sequential(id, feature_akustik), construct_sequential(id, feature_leksikal), construct_sequential(id, feature_concat)\n","print(sequential_features_akustik.shape, sequential_features_leksikal.shape, sequential_features_concat.shape)"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":50,"status":"ok","timestamp":1622634483561,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"WhAPM-fz6Lpo","outputId":"6167f1ae-c5be-4628-c823-0955dc693beb"},"outputs":[{"name":"stdout","output_type":"stream","text":["(2003,)\n"]}],"source":["abstraksi = construct_abstract(id, data['Abstraksi Emosi'])\n","print(abstraksi.shape)"]},{"cell_type":"markdown","metadata":{"id":"ywmC9OLaBBtk"},"source":["### Label One Hot Encoding"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":49,"status":"ok","timestamp":1622634483562,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"nIBZ7Y9mndE8","outputId":"d3bdcb3b-d9e7-4c87-f6c3-25c013157db0"},"outputs":[{"data":{"text/plain":["(2003,)"]},"execution_count":14,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["encoder_ucapan = OneHotEncoder(sparse=False)\n","labels = np.array(data['Label Emosi']).reshape(-1, 1)\n","labels = encoder_ucapan.fit_transform(labels)\n","labels = construct_sequential(id, labels)\n","labels.shape"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":46,"status":"ok","timestamp":1622634483563,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"UhdAHD0FBEYt","outputId":"45b6c1e2-84f4-4dc9-dc74-6597431b6232"},"outputs":[{"data":{"text/plain":["(2003, 6)"]},"execution_count":15,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["encoder_cakapan = OneHotEncoder(sparse=False)\n","abstraksi = abstraksi.reshape(-1, 1)\n","abstraksi = encoder_cakapan.fit_transform(abstraksi)\n","abstraksi.shape"]},{"cell_type":"markdown","metadata":{"id":"vmmhadrMiDBZ"},"source":["### Split Train and Test Data"]},{"cell_type":"code","execution_count":16,"metadata":{"executionInfo":{"elapsed":43,"status":"ok","timestamp":1622634483565,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"crXuOPhhiDBa"},"outputs":[],"source":["X_akustik = sequential_features_akustik\n","X_leksikal = sequential_features_leksikal\n","X_concat = sequential_features_concat\n","y_sequential = labels\n","y = abstraksi"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1734,"status":"ok","timestamp":1622634485258,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"gj7wje6IiDBb","outputId":"4f673769-6724-4c49-f261-244c0609fb8f"},"outputs":[{"name":"stdout","output_type":"stream","text":["Data (2003, 15, 88) (2003, 15, 5017) (2003, 15, 5105)\n","Label (2003, 6) (2003, 15, 6)\n"]}],"source":["X_akustik = tf.keras.preprocessing.sequence.pad_sequences(X_akustik, padding=\"post\", dtype='float32')\n","X_leksikal = tf.keras.preprocessing.sequence.pad_sequences(X_leksikal, padding=\"post\", dtype='float32')\n","X_concat = tf.keras.preprocessing.sequence.pad_sequences(X_concat, padding=\"post\", dtype='float32')\n","y_sequential = tf.keras.preprocessing.sequence.pad_sequences(y_sequential, padding=\"post\", dtype='float32')\n","y = tf.keras.preprocessing.sequence.pad_sequences(y, padding=\"post\", dtype='float32')\n","print(\"Data\", X_akustik.shape, X_leksikal.shape, X_concat.shape)\n","print(\"Label\", y.shape, y_sequential.shape)"]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":39,"status":"ok","timestamp":1622634485260,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"W0yD-qvIi4AA","outputId":"0355a8a2-def7-4fa9-b42e-28db914fc975"},"outputs":[{"name":"stdout","output_type":"stream","text":["Train data (1702,)\n","Test data (301,)\n"]}],"source":["sss = StratifiedShuffleSplit(n_splits=1, test_size=0.15, random_state=42)\n","for train_index, test_index in sss.split(X_concat, y):\n","  train_index, test_index = train_index, test_index\n","print(\"Train data\", train_index.shape)\n","print(\"Test data\", test_index.shape)"]},{"cell_type":"markdown","metadata":{"id":"fYi1B1JJjRWP"},"source":["#### Eliminate Minority Label"]},{"cell_type":"code","execution_count":19,"metadata":{"executionInfo":{"elapsed":37,"status":"ok","timestamp":1622634485262,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"Tik8qTNajZyk"},"outputs":[],"source":["def get_label_idxs(list, label):\n","  idxs = []\n","  for i in range(len(list)):\n","    for l in label:\n","      if list[i] == l:\n","        idxs.append(i)\n","  return np.array(idxs)"]},{"cell_type":"code","execution_count":20,"metadata":{"executionInfo":{"elapsed":37,"status":"ok","timestamp":1622634485264,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"lsIdrosKAZqj"},"outputs":[],"source":["def delete_elArr_by_idx(arr, idx):\n","  new_arr = []\n","  for i in range(len(arr)):\n","    if i not in idx:\n","      new_arr.append(arr[i])\n","  return np.array(new_arr)"]},{"cell_type":"code","execution_count":21,"metadata":{"executionInfo":{"elapsed":34,"status":"ok","timestamp":1622634485266,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"A9xGFWpgjldm"},"outputs":[],"source":["dec_abstraksi = encoder_cakapan.inverse_transform(abstraksi)\n","del_idxs = get_label_idxs(dec_abstraksi, [\"Jijik\", \"Takut\"])"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":34,"status":"ok","timestamp":1622634485268,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"OSSxfCzGjZyl","outputId":"6acab82c-cd05-4dd2-9e65-6653f3ccce65"},"outputs":[{"name":"stdout","output_type":"stream","text":["(1936,) (1936,) (1936,) (1936,)\n"]}],"source":["X_akustik_4 = np.delete(sequential_features_akustik, del_idxs)\n","X_leksikal_4 = np.delete(sequential_features_leksikal, del_idxs)\n","X_concat_4 = np.delete(sequential_features_concat, del_idxs)\n","label_4 = np.delete(dec_abstraksi, del_idxs)\n","print(X_akustik_4.shape, X_leksikal_4.shape, X_concat_4.shape, label_4.shape)"]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":31,"status":"ok","timestamp":1622634485269,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"wkfHI7eCjZym","outputId":"51af036a-8b3d-4f6e-ca19-fa4ed988ebaf"},"outputs":[{"data":{"text/plain":["(1936, 4)"]},"execution_count":23,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["encoder_cakapan_4 = OneHotEncoder(sparse=False)\n","label_4 = label_4.reshape(-1, 1)\n","label_4 = encoder_cakapan_4.fit_transform(label_4)\n","label_4.shape"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1872,"status":"ok","timestamp":1622634487114,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"3-rYa936jZyn","outputId":"9099e316-1dc8-473a-cf71-98a1cfbb253e"},"outputs":[{"name":"stdout","output_type":"stream","text":["(1936, 15, 88) (1936, 15, 5017) (1936, 15, 5105) (1936, 4)\n"]}],"source":["X_akustik_4 = tf.keras.preprocessing.sequence.pad_sequences(X_akustik_4, padding=\"post\", dtype='float32')\n","X_leksikal_4 = tf.keras.preprocessing.sequence.pad_sequences(X_leksikal_4, padding=\"post\", dtype='float32')\n","X_concat_4 = tf.keras.preprocessing.sequence.pad_sequences(X_concat_4, padding=\"post\", dtype='float32')\n","y_4 = tf.keras.preprocessing.sequence.pad_sequences(label_4, padding=\"post\", dtype='float32')\n","print(X_akustik_4.shape, X_leksikal_4.shape, X_concat_4.shape, y_4.shape)"]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1622634487117,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"MP0y3CD0jZyo","outputId":"2e7c2413-c917-44dc-e6eb-5b3c6cedb189"},"outputs":[{"name":"stdout","output_type":"stream","text":["Train data (1645,)\n","Test data (291,)\n"]}],"source":["sss_4 = StratifiedShuffleSplit(n_splits=1, test_size=0.15, random_state=42)\n","for train_index_4, test_index_4 in sss_4.split(X_akustik_4, y_4):\n","  train_index_4, test_index_4 = train_index_4, test_index_4\n","print(\"Train data\", train_index_4.shape)\n","print(\"Test data\", test_index_4.shape)"]},{"cell_type":"markdown","metadata":{"id":"oRqlfeEdG8FK"},"source":["## 1. Model Gabungan Level Fitur"]},{"cell_type":"markdown","metadata":{"id":"uUDafrfVKwNx"},"source":["### Modelling Preparation"]},{"cell_type":"markdown","metadata":{"id":"fNRphlZOBBgB"},"source":["#### Define Model"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"krJyoDWJUvE7"},"outputs":[],"source":["def get_contextual_model(shape, label_shape):\n","  model = Sequential()\n","  model.add(layers.Masking(mask_value=0, input_shape=shape))\n","  model.add(layers.LSTM(128, return_sequences=True))\n","  model.add(layers.Dropout(0.2))\n","  model.add(layers.Dense(128, activation='relu'))\n","  model.add(layers.Dense(label_shape, activation='softmax'))\n","  return model"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4LYhKwFFUvE9"},"outputs":[],"source":["def get_classification_model(shape, label_shape):\n","  model = Sequential()\n","  model.add(layers.Masking(mask_value=0, input_shape=shape))\n","  model.add(layers.LSTM(128))\n","  model.add(layers.Dropout(0.2))\n","  model.add(layers.Dense(128, activation='relu'))\n","  model.add(layers.Dense(label_shape, activation='softmax'))\n","  return model"]},{"cell_type":"markdown","metadata":{"id":"POcO9_l8R5o9"},"source":["#### Define Training Parameter"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2QO-OCOGBBgG"},"outputs":[],"source":["batch_size = 32\n","epochs = 20\n","validation_split = 0.2\n","optimizer = 'adam'\n","loss = 'categorical_crossentropy'\n","metrics = ['accuracy']\n","callbacks = [EarlyStopping(monitor='val_accuracy', mode='max', min_delta=0.0001, patience=3, restore_best_weights=True)]"]},{"cell_type":"markdown","metadata":{"id":"rOdKIa-rK4d4"},"source":["#### Define Schema Experiment"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VDF3ruH1GC3e"},"outputs":[],"source":["def train_5fold_cv(X, y, shape, label_shape, return_sequences):\n","\n","  loss_score = []\n","  accuracy_score = []  \n","\n","  cv = KFold(n_splits=5, random_state=42, shuffle=True)\n","\n","  for train_index, val_index in cv.split(X):\n","      \n","      X_train, X_val, y_train, y_val = X[train_index], X[val_index], y[train_index], y[val_index]\n","      \n","      model = None\n","      if return_sequences :\n","        model = get_contextual_model(shape, label_shape)\n","      else :\n","        model = get_classification_model(shape, label_shape)\n","      model.compile(loss=loss, optimizer=optimizer, metrics=metrics)\n","      model.fit(X_train, y_train,\n","              validation_data=(X_val, y_val),\n","              epochs=epochs,\n","              batch_size=batch_size,\n","              callbacks=callbacks)\n","      \n","      l, a = model.evaluate(X_val, y_val)\n","      loss_score.append(l)\n","      accuracy_score.append(a)\n","  \n","  loss_score = np.round(np.mean(loss_score), 4)\n","  accuracy_score = np.round(np.mean(accuracy_score), 4)\n","  print(\"Loss Score : \", loss_score, \"Accuracy Score : \", accuracy_score)\n","  return loss_score, accuracy_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"v0EFJ-F6Xlak"},"outputs":[],"source":["def train_stratified_random_sampling(X_train, y_train, X_test, y_test, shape, label_shape, return_sequences):\n","\n","  model = None\n","  if return_sequences :\n","    model = get_contextual_model(shape, label_shape)\n","  else :\n","    model = get_classification_model(shape, label_shape)\n","  model.compile(loss=loss, optimizer=optimizer, metrics=metrics)\n","  model.fit(X_train, y_train,\n","            validation_data=(X_test, y_test),\n","            epochs=epochs,\n","            batch_size=batch_size,\n","            callbacks=callbacks)\n","      \n","  loss_score, accuracy_score = model.evaluate(X_test, y_test)\n","  loss_score = np.round(np.mean(loss_score), 4)\n","  accuracy_score = np.round(np.mean(accuracy_score), 4)\n","\n","  print(\"Loss Score : \", loss_score, \"Accuracy Score : \", accuracy_score)\n","  \n","  return model, accuracy_score"]},{"cell_type":"markdown","metadata":{"id":"SIFvY96Cnvym"},"source":["### Contextual Model"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XNQSkmMMT0z9"},"outputs":[],"source":["def run_contextual_model(X_train, y_train, X_test, y_test, n):\n","  model = None\n","  best_acc = 0\n","  for i in range(n):\n","    model, accuracy_score = train_stratified_random_sampling(X_train, y_train, X_test, y_test, X_train.shape[1:], y_train.shape[2], True)\n","    if best_acc \u003c accuracy_score:\n","      best_acc = accuracy_score\n","      best_model = model\n","  return best_model"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":80900,"status":"ok","timestamp":1622525727240,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"XMk8mP4BUBBq","outputId":"3a355a4b-dec1-47e4-a722-7985607c5cb4"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/20\n","54/54 [==============================] - 6s 39ms/step - loss: 0.5777 - accuracy: 0.3167 - val_loss: 0.4915 - val_accuracy: 0.3512\n","Epoch 2/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.5147 - accuracy: 0.3750 - val_loss: 0.4931 - val_accuracy: 0.3429\n","Epoch 3/20\n","54/54 [==============================] - 1s 16ms/step - loss: 0.4900 - accuracy: 0.4055 - val_loss: 0.4702 - val_accuracy: 0.3997\n","Epoch 4/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4600 - accuracy: 0.4921 - val_loss: 0.4429 - val_accuracy: 0.4387\n","Epoch 5/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3955 - accuracy: 0.5844 - val_loss: 0.4281 - val_accuracy: 0.4981\n","Epoch 6/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3155 - accuracy: 0.6727 - val_loss: 0.4304 - val_accuracy: 0.5115\n","Epoch 7/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2662 - accuracy: 0.7435 - val_loss: 0.4585 - val_accuracy: 0.5128\n","Epoch 8/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2195 - accuracy: 0.7773 - val_loss: 0.5077 - val_accuracy: 0.5038\n","Epoch 9/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1802 - accuracy: 0.8199 - val_loss: 0.5000 - val_accuracy: 0.5077\n","Epoch 10/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1476 - accuracy: 0.8614 - val_loss: 0.5573 - val_accuracy: 0.5089\n","10/10 [==============================] - 0s 8ms/step - loss: 0.4585 - accuracy: 0.5128\n","Loss Score :  0.4585 Accuracy Score :  0.5128\n","Epoch 1/20\n","54/54 [==============================] - 6s 38ms/step - loss: 0.5561 - accuracy: 0.3478 - val_loss: 0.4909 - val_accuracy: 0.3838\n","Epoch 2/20\n","54/54 [==============================] - 1s 16ms/step - loss: 0.5113 - accuracy: 0.3747 - val_loss: 0.4834 - val_accuracy: 0.3812\n","Epoch 3/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4970 - accuracy: 0.3914 - val_loss: 0.4913 - val_accuracy: 0.3608\n","Epoch 4/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4574 - accuracy: 0.4805 - val_loss: 0.4380 - val_accuracy: 0.4508\n","Epoch 5/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4002 - accuracy: 0.5741 - val_loss: 0.4370 - val_accuracy: 0.4751\n","Epoch 6/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3261 - accuracy: 0.6628 - val_loss: 0.4744 - val_accuracy: 0.5051\n","Epoch 7/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2733 - accuracy: 0.7353 - val_loss: 0.4402 - val_accuracy: 0.5102\n","Epoch 8/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2152 - accuracy: 0.7872 - val_loss: 0.4877 - val_accuracy: 0.5121\n","Epoch 9/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1758 - accuracy: 0.8281 - val_loss: 0.4988 - val_accuracy: 0.5000\n","Epoch 10/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1378 - accuracy: 0.8655 - val_loss: 0.5530 - val_accuracy: 0.4898\n","Epoch 11/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1173 - accuracy: 0.8906 - val_loss: 0.6425 - val_accuracy: 0.4955\n","10/10 [==============================] - 0s 8ms/step - loss: 0.4877 - accuracy: 0.5121\n","Loss Score :  0.4877 Accuracy Score :  0.5121\n","Epoch 1/20\n","54/54 [==============================] - 6s 45ms/step - loss: 0.5492 - accuracy: 0.3396 - val_loss: 0.4878 - val_accuracy: 0.3519\n","Epoch 2/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.5100 - accuracy: 0.3832 - val_loss: 0.4859 - val_accuracy: 0.3442\n","Epoch 3/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4793 - accuracy: 0.4208 - val_loss: 0.4540 - val_accuracy: 0.4361\n","Epoch 4/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4316 - accuracy: 0.5142 - val_loss: 0.4528 - val_accuracy: 0.4189\n","Epoch 5/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3844 - accuracy: 0.5865 - val_loss: 0.4540 - val_accuracy: 0.4751\n","Epoch 6/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3336 - accuracy: 0.6635 - val_loss: 0.4414 - val_accuracy: 0.5096\n","Epoch 7/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2776 - accuracy: 0.7264 - val_loss: 0.4519 - val_accuracy: 0.4962\n","Epoch 8/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2114 - accuracy: 0.7919 - val_loss: 0.5543 - val_accuracy: 0.4515\n","Epoch 9/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1958 - accuracy: 0.8033 - val_loss: 0.5306 - val_accuracy: 0.5013\n","10/10 [==============================] - 0s 9ms/step - loss: 0.4414 - accuracy: 0.5096\n","Loss Score :  0.4414 Accuracy Score :  0.5096\n","Epoch 1/20\n","54/54 [==============================] - 5s 38ms/step - loss: 0.5691 - accuracy: 0.3413 - val_loss: 0.4934 - val_accuracy: 0.3429\n","Epoch 2/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.5189 - accuracy: 0.3800 - val_loss: 0.4808 - val_accuracy: 0.3927\n","Epoch 3/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4963 - accuracy: 0.3992 - val_loss: 0.4911 - val_accuracy: 0.3787\n","Epoch 4/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4576 - accuracy: 0.4918 - val_loss: 0.4850 - val_accuracy: 0.3774\n","Epoch 5/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3752 - accuracy: 0.5939 - val_loss: 0.4333 - val_accuracy: 0.4866\n","Epoch 6/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3336 - accuracy: 0.6638 - val_loss: 0.4500 - val_accuracy: 0.5077\n","Epoch 7/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2462 - accuracy: 0.7580 - val_loss: 0.4624 - val_accuracy: 0.5026\n","Epoch 8/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2255 - accuracy: 0.7809 - val_loss: 0.5012 - val_accuracy: 0.4911\n","Epoch 9/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1723 - accuracy: 0.8409 - val_loss: 0.5583 - val_accuracy: 0.4815\n","10/10 [==============================] - 0s 9ms/step - loss: 0.4500 - accuracy: 0.5077\n","Loss Score :  0.45 Accuracy Score :  0.5077\n","Epoch 1/20\n","54/54 [==============================] - 6s 53ms/step - loss: 0.5485 - accuracy: 0.3417 - val_loss: 0.4889 - val_accuracy: 0.3570\n","Epoch 2/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.5086 - accuracy: 0.3855 - val_loss: 0.4771 - val_accuracy: 0.4017\n","Epoch 3/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4950 - accuracy: 0.4167 - val_loss: 0.4551 - val_accuracy: 0.4132\n","Epoch 4/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.4461 - accuracy: 0.4774 - val_loss: 0.4473 - val_accuracy: 0.4432\n","Epoch 5/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.3879 - accuracy: 0.5750 - val_loss: 0.4483 - val_accuracy: 0.4713\n","Epoch 6/20\n","54/54 [==============================] - 1s 16ms/step - loss: 0.3340 - accuracy: 0.6429 - val_loss: 0.4681 - val_accuracy: 0.4732\n","Epoch 7/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2511 - accuracy: 0.7523 - val_loss: 0.5074 - val_accuracy: 0.4623\n","Epoch 8/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.2359 - accuracy: 0.7653 - val_loss: 0.4948 - val_accuracy: 0.4911\n","Epoch 9/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1821 - accuracy: 0.8265 - val_loss: 0.5124 - val_accuracy: 0.5192\n","Epoch 10/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1407 - accuracy: 0.8716 - val_loss: 0.5712 - val_accuracy: 0.4936\n","Epoch 11/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.1339 - accuracy: 0.8715 - val_loss: 0.6586 - val_accuracy: 0.4981\n","Epoch 12/20\n","54/54 [==============================] - 1s 15ms/step - loss: 0.0894 - accuracy: 0.9172 - val_loss: 0.6609 - val_accuracy: 0.4732\n","10/10 [==============================] - 0s 9ms/step - loss: 0.5124 - accuracy: 0.5192\n","Loss Score :  0.5124 Accuracy Score :  0.5192\n"]}],"source":["contextual_model = run_contextual_model(X_concat[train_index], y_sequential[train_index], X_concat[test_index], y_sequential[test_index], 5)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":39,"status":"ok","timestamp":1622525727241,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"irYe0sk0T3dD","outputId":"de5aa60b-0ac4-4e77-aa1f-cc0589b68630"},"outputs":[{"name":"stdout","output_type":"stream","text":["10/10 [==============================] - 0s 9ms/step - loss: 0.5124 - accuracy: 0.5192\n"]},{"data":{"text/plain":["[0.5123841762542725, 0.5191571116447449]"]},"execution_count":100,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["contextual_model.evaluate(X_concat[test_index], y_sequential[test_index])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8ZJqB-jCUgZi"},"outputs":[],"source":["contextual_model.save(drive_dir + \"/Eksperimen/Model/model_gabungan_bertahap_contextual.h5\")"]},{"cell_type":"markdown","metadata":{"id":"SFQD1ZH4muw_"},"source":["### Extract Contextual Features"]},{"cell_type":"markdown","metadata":{"id":"XWTCeteIJ_rQ"},"source":["#### Concat Data"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2337,"status":"ok","timestamp":1622618418363,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"v_SFjWZgl8BK","outputId":"a442f344-48ec-4ccd-9c2e-4c23f1ce1ef8"},"outputs":[{"name":"stdout","output_type":"stream","text":["10/10 [==============================] - 1s 10ms/step - loss: 0.5124 - accuracy: 0.5192\n"]},{"data":{"text/plain":["[0.5123841762542725, 0.5191571116447449]"]},"execution_count":94,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["contextual_model = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_gabungan_bertahap_contextual.h5\")\n","contextual_model.evaluate(X_concat[test_index], y_sequential[test_index])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cQvF9KX4lx-C"},"outputs":[],"source":["def extract_contextual_features(model, idx_output, data):\n","  get_relu_output = backend.function([model.layers[0].input], [model.layers[idx_output].output])\n","  relu_output = get_relu_output([data])\n","  return np.array(relu_output[0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1622618418368,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"gyu-H0dcTevJ","outputId":"f93beae4-7631-4ec5-a1c5-e18b7234b919"},"outputs":[{"data":{"text/plain":["(2003, 15, 128)"]},"execution_count":96,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["contextual_features_concat = extract_contextual_features(contextual_model, 3, X_concat)\n","contextual_features_concat.shape"]},{"cell_type":"markdown","metadata":{"id":"hstlRu2cKB10"},"source":["#### Concat Extracted Feature"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HPLMn_oIKnTg"},"outputs":[],"source":["def concat_sequential_features(feature_1, feature_2):\n","  sequential_features = []\n","  for i in range(len(feature_1)):\n","    features = []\n","    for j in range(len(feature_1[i])):\n","      temp = []\n","      temp.extend(feature_1[i][j])\n","      temp.extend(feature_2[i][j])\n","      features.append(np.array(temp))\n","    sequential_features.append(np.array(features))\n","  return np.array(sequential_features)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ez-c9ZLsKEQh"},"outputs":[],"source":["model_akustik_contextual = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_akustik_bertahap_contextual.h5\")\n","model_leksikal_contextual = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_leksikal_bertahap_contextual.h5\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":923,"status":"ok","timestamp":1622541589130,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"cFsXfwsVKLE8","outputId":"aa4c63e2-38b4-446f-b275-d703919a009c"},"outputs":[{"name":"stdout","output_type":"stream","text":["(2003, 15, 128) (2003, 15, 64)\n"]}],"source":["contextual_feature_akustik = extract_contextual_features(model_akustik_contextual, 3, X_akustik)\n","contextual_feature_leksikal = extract_contextual_features(model_leksikal_contextual, 3, X_leksikal)\n","print(contextual_feature_akustik.shape, contextual_feature_leksikal.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1837,"status":"ok","timestamp":1622541590952,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"ZOLX46LBMuSr","outputId":"3c958c30-456c-4ef1-9324-f2a2f5f27c5d"},"outputs":[{"data":{"text/plain":["(2003, 15, 192)"]},"execution_count":38,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["contextual_features_concat_2 = concat_sequential_features(contextual_feature_akustik, contextual_feature_leksikal)\n","contextual_features_concat_2.shape"]},{"cell_type":"markdown","metadata":{"id":"e9rJwqPpzq9c"},"source":["### Classification Model"]},{"cell_type":"markdown","metadata":{"id":"yX-aIRhqNTuW"},"source":["#### Concat Data"]},{"cell_type":"markdown","metadata":{"id":"QVm6Ph1SmpxF"},"source":["##### 6 Kelas Emosi"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"stoTrOU3Za5D"},"outputs":[],"source":["def run_classification_model(X_train, y_train, X_test, y_test, n):\n","  model = None\n","  best_acc = 0\n","  for i in range(n):\n","    model, accuracy_score = train_stratified_random_sampling(X_train, y_train, X_test, y_test, X_train.shape[1:], y_train.shape[1], False)\n","    if best_acc \u003c accuracy_score:\n","      best_acc = accuracy_score\n","      best_model = model\n","  return best_model"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":94272,"status":"ok","timestamp":1622618634645,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"6Gj0s0BBoPDO","outputId":"e4b9e02f-0db2-41f0-e8b8-e0d59f48eb7a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/20\n","54/54 [==============================] - 6s 51ms/step - loss: 1.1664 - accuracy: 0.6300 - val_loss: 1.4156 - val_accuracy: 0.5316\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4889 - accuracy: 0.8312 - val_loss: 1.5426 - val_accuracy: 0.5382\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4151 - accuracy: 0.8630 - val_loss: 1.5680 - val_accuracy: 0.5216\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3954 - accuracy: 0.8660 - val_loss: 1.4609 - val_accuracy: 0.5449\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4149 - accuracy: 0.8545 - val_loss: 1.4846 - val_accuracy: 0.5681\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3319 - accuracy: 0.8839 - val_loss: 1.5114 - val_accuracy: 0.5548\n","Epoch 7/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3310 - accuracy: 0.8765 - val_loss: 1.4597 - val_accuracy: 0.5515\n","Epoch 8/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3326 - accuracy: 0.8850 - val_loss: 1.5522 - val_accuracy: 0.5581\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4846 - accuracy: 0.5681\n","Loss Score :  1.4846 Accuracy Score :  0.5681\n","Epoch 1/20\n","54/54 [==============================] - 5s 34ms/step - loss: 1.2383 - accuracy: 0.5460 - val_loss: 1.4571 - val_accuracy: 0.5349\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5177 - accuracy: 0.8275 - val_loss: 1.4863 - val_accuracy: 0.5083\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3955 - accuracy: 0.8685 - val_loss: 1.4076 - val_accuracy: 0.5648\n","Epoch 4/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.3688 - accuracy: 0.8753 - val_loss: 1.4393 - val_accuracy: 0.5615\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3597 - accuracy: 0.8727 - val_loss: 1.4955 - val_accuracy: 0.5282\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3419 - accuracy: 0.8802 - val_loss: 1.5862 - val_accuracy: 0.5415\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4076 - accuracy: 0.5648\n","Loss Score :  1.4076 Accuracy Score :  0.5648\n","Epoch 1/20\n","54/54 [==============================] - 6s 31ms/step - loss: 1.1915 - accuracy: 0.5679 - val_loss: 1.4346 - val_accuracy: 0.5515\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5081 - accuracy: 0.8293 - val_loss: 1.6221 - val_accuracy: 0.5449\n","Epoch 3/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.4478 - accuracy: 0.8552 - val_loss: 1.7069 - val_accuracy: 0.5581\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3827 - accuracy: 0.8727 - val_loss: 1.4957 - val_accuracy: 0.5648\n","Epoch 5/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.3641 - accuracy: 0.8788 - val_loss: 1.6468 - val_accuracy: 0.5449\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3502 - accuracy: 0.8737 - val_loss: 1.4351 - val_accuracy: 0.5548\n","Epoch 7/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.3206 - accuracy: 0.8851 - val_loss: 1.3621 - val_accuracy: 0.5515\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4957 - accuracy: 0.5648\n","Loss Score :  1.4957 Accuracy Score :  0.5648\n","Epoch 1/20\n","54/54 [==============================] - 5s 30ms/step - loss: 1.1878 - accuracy: 0.5837 - val_loss: 1.4388 - val_accuracy: 0.5282\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4990 - accuracy: 0.8264 - val_loss: 1.4279 - val_accuracy: 0.5581\n","Epoch 3/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.4354 - accuracy: 0.8631 - val_loss: 1.5523 - val_accuracy: 0.5349\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4044 - accuracy: 0.8641 - val_loss: 1.6720 - val_accuracy: 0.5382\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3547 - accuracy: 0.8809 - val_loss: 1.4753 - val_accuracy: 0.5449\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4279 - accuracy: 0.5581\n","Loss Score :  1.4279 Accuracy Score :  0.5581\n","Epoch 1/20\n","54/54 [==============================] - 6s 33ms/step - loss: 1.2288 - accuracy: 0.5502 - val_loss: 1.4567 - val_accuracy: 0.5515\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5055 - accuracy: 0.8336 - val_loss: 1.5053 - val_accuracy: 0.5349\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4819 - accuracy: 0.8414 - val_loss: 1.7207 - val_accuracy: 0.5349\n","Epoch 4/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.3942 - accuracy: 0.8641 - val_loss: 1.5077 - val_accuracy: 0.5482\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4567 - accuracy: 0.5515\n","Loss Score :  1.4567 Accuracy Score :  0.5515\n","Epoch 1/20\n","54/54 [==============================] - 5s 32ms/step - loss: 1.2230 - accuracy: 0.5403 - val_loss: 1.5179 - val_accuracy: 0.5415\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5670 - accuracy: 0.8212 - val_loss: 1.4403 - val_accuracy: 0.5482\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4415 - accuracy: 0.8502 - val_loss: 1.6124 - val_accuracy: 0.5216\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4140 - accuracy: 0.8668 - val_loss: 1.4965 - val_accuracy: 0.5382\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3387 - accuracy: 0.8780 - val_loss: 1.3863 - val_accuracy: 0.5615\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3817 - accuracy: 0.8629 - val_loss: 1.5911 - val_accuracy: 0.5515\n","Epoch 7/20\n","54/54 [==============================] - 0s 9ms/step - loss: 0.3234 - accuracy: 0.8858 - val_loss: 1.5903 - val_accuracy: 0.5515\n","Epoch 8/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3455 - accuracy: 0.8737 - val_loss: 1.5170 - val_accuracy: 0.5548\n","10/10 [==============================] - 0s 4ms/step - loss: 1.3863 - accuracy: 0.5615\n","Loss Score :  1.3863 Accuracy Score :  0.5615\n","Epoch 1/20\n","54/54 [==============================] - 6s 33ms/step - loss: 1.2642 - accuracy: 0.5018 - val_loss: 1.5907 - val_accuracy: 0.5249\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5367 - accuracy: 0.8209 - val_loss: 1.5666 - val_accuracy: 0.4983\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4308 - accuracy: 0.8580 - val_loss: 1.3756 - val_accuracy: 0.5415\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3766 - accuracy: 0.8832 - val_loss: 1.4598 - val_accuracy: 0.5714\n","Epoch 5/20\n","54/54 [==============================] - 0s 7ms/step - loss: 0.3639 - accuracy: 0.8851 - val_loss: 1.4811 - val_accuracy: 0.5581\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3568 - accuracy: 0.8750 - val_loss: 1.5229 - val_accuracy: 0.5681\n","Epoch 7/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3212 - accuracy: 0.9026 - val_loss: 1.4996 - val_accuracy: 0.5449\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4598 - accuracy: 0.5714\n","Loss Score :  1.4598 Accuracy Score :  0.5714\n","Epoch 1/20\n","54/54 [==============================] - 5s 31ms/step - loss: 1.2458 - accuracy: 0.5045 - val_loss: 1.4083 - val_accuracy: 0.5415\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5593 - accuracy: 0.8278 - val_loss: 1.3941 - val_accuracy: 0.5216\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4178 - accuracy: 0.8741 - val_loss: 1.4759 - val_accuracy: 0.5183\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4136 - accuracy: 0.8507 - val_loss: 1.4576 - val_accuracy: 0.5548\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3966 - accuracy: 0.8687 - val_loss: 1.6506 - val_accuracy: 0.5449\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3536 - accuracy: 0.8861 - val_loss: 1.5444 - val_accuracy: 0.5581\n","Epoch 7/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3532 - accuracy: 0.8809 - val_loss: 1.5773 - val_accuracy: 0.5748\n","Epoch 8/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3284 - accuracy: 0.8803 - val_loss: 1.4207 - val_accuracy: 0.5615\n","Epoch 9/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3235 - accuracy: 0.8884 - val_loss: 1.6180 - val_accuracy: 0.5681\n","Epoch 10/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3386 - accuracy: 0.8723 - val_loss: 1.6117 - val_accuracy: 0.5714\n","10/10 [==============================] - 0s 4ms/step - loss: 1.5773 - accuracy: 0.5748\n","Loss Score :  1.5773 Accuracy Score :  0.5748\n","Epoch 1/20\n","54/54 [==============================] - 6s 31ms/step - loss: 1.1901 - accuracy: 0.5435 - val_loss: 1.6987 - val_accuracy: 0.5482\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5538 - accuracy: 0.8188 - val_loss: 1.5459 - val_accuracy: 0.5415\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4017 - accuracy: 0.8709 - val_loss: 1.4657 - val_accuracy: 0.5548\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3984 - accuracy: 0.8665 - val_loss: 1.3717 - val_accuracy: 0.5581\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3610 - accuracy: 0.8835 - val_loss: 1.5702 - val_accuracy: 0.5548\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3695 - accuracy: 0.8704 - val_loss: 1.4551 - val_accuracy: 0.5515\n","Epoch 7/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3515 - accuracy: 0.8830 - val_loss: 1.4952 - val_accuracy: 0.5648\n","Epoch 8/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3034 - accuracy: 0.8875 - val_loss: 1.5372 - val_accuracy: 0.5615\n","Epoch 9/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3434 - accuracy: 0.8884 - val_loss: 1.5604 - val_accuracy: 0.5482\n","Epoch 10/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3338 - accuracy: 0.8856 - val_loss: 1.5572 - val_accuracy: 0.5349\n","10/10 [==============================] - 0s 4ms/step - loss: 1.4952 - accuracy: 0.5648\n","Loss Score :  1.4952 Accuracy Score :  0.5648\n","Epoch 1/20\n","54/54 [==============================] - 6s 39ms/step - loss: 1.1877 - accuracy: 0.5632 - val_loss: 1.4079 - val_accuracy: 0.5415\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5072 - accuracy: 0.8326 - val_loss: 1.4956 - val_accuracy: 0.5449\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3943 - accuracy: 0.8597 - val_loss: 1.5401 - val_accuracy: 0.5714\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4328 - accuracy: 0.8506 - val_loss: 1.6010 - val_accuracy: 0.5415\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3387 - accuracy: 0.8880 - val_loss: 1.6284 - val_accuracy: 0.5482\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3187 - accuracy: 0.9015 - val_loss: 1.5940 - val_accuracy: 0.5415\n","10/10 [==============================] - 0s 4ms/step - loss: 1.5401 - accuracy: 0.5714\n","Loss Score :  1.5401 Accuracy Score :  0.5714\n"]}],"source":["callbacks = [EarlyStopping(monitor='val_accuracy', mode='max', min_delta=0.0001, patience=3, restore_best_weights=True)]\n","classification_model = run_classification_model(contextual_features_concat[train_index], y[train_index], contextual_features_concat[test_index], y[test_index], 1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12566,"status":"ok","timestamp":1622618686612,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"-hu94DxOojOF","outputId":"f1160854-5972-45d9-c522-5e8d325e6ed2"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/20\n","54/54 [==============================] - 7s 32ms/step - loss: 1.2378 - accuracy: 0.5587 - val_loss: 1.3885 - val_accuracy: 0.5183\n","Epoch 2/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.5326 - accuracy: 0.8337 - val_loss: 1.5361 - val_accuracy: 0.5316\n","Epoch 3/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4399 - accuracy: 0.8570 - val_loss: 1.5352 - val_accuracy: 0.5116\n","Epoch 4/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.4173 - accuracy: 0.8623 - val_loss: 1.5098 - val_accuracy: 0.5382\n","Epoch 5/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3986 - accuracy: 0.8673 - val_loss: 1.5708 - val_accuracy: 0.5648\n","Epoch 6/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3663 - accuracy: 0.8762 - val_loss: 1.5419 - val_accuracy: 0.5880\n","Epoch 7/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3264 - accuracy: 0.8862 - val_loss: 1.6294 - val_accuracy: 0.5615\n","Epoch 8/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3423 - accuracy: 0.8811 - val_loss: 1.4976 - val_accuracy: 0.5681\n","Epoch 9/20\n","54/54 [==============================] - 0s 8ms/step - loss: 0.3179 - accuracy: 0.8917 - val_loss: 1.6022 - val_accuracy: 0.5482\n","10/10 [==============================] - 0s 4ms/step - loss: 1.5419 - accuracy: 0.5880\n","Loss Score :  1.5419 Accuracy Score :  0.588\n","              precision    recall  f1-score   support\n","\n","       Jijik     0.0000    0.0000    0.0000         1\n","       Marah     0.5938    0.4524    0.5135        42\n","       Sedih     0.5192    0.6279    0.5684        86\n","      Senang     0.6726    0.6726    0.6726       113\n","       Takut     0.5000    0.1111    0.1818         9\n","    Terkejut     0.5400    0.5400    0.5400        50\n","\n","    accuracy                         0.5880       301\n","   macro avg     0.4709    0.4007    0.4127       301\n","weighted avg     0.5883    0.5880    0.5817       301\n","\n","[[ 0  0  1  0  0  0]\n"," [ 0 19 16  3  0  4]\n"," [ 0  3 54 22  0  7]\n"," [ 0  3 22 76  0 12]\n"," [ 0  1  4  3  1  0]\n"," [ 0  6  7  9  1 27]]\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}],"source":["classification_model = run_classification_model(contextual_features_concat[train_index], y[train_index], contextual_features_concat[test_index], y[test_index], 1)\n","pred = classification_model.predict(contextual_features_concat[test_index])\n","y_pred = encoder_cakapan.inverse_transform(pred)\n","y_true = encoder_cakapan.inverse_transform(y[test_index])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred)) "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f8WcVnjIZgq9"},"outputs":[],"source":["classification_model.save(drive_dir + \"/Eksperimen/Model/model_gabungan_bertahap_classification_6.h5\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2051,"status":"ok","timestamp":1622618701858,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"mmmglEtbrqbx","outputId":"07a4af75-8a26-4fbd-860e-1d3406d3a7ab"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Jijik     0.0000    0.0000    0.0000         1\n","       Marah     0.5938    0.4524    0.5135        42\n","       Sedih     0.5192    0.6279    0.5684        86\n","      Senang     0.6726    0.6726    0.6726       113\n","       Takut     0.5000    0.1111    0.1818         9\n","    Terkejut     0.5400    0.5400    0.5400        50\n","\n","    accuracy                         0.5880       301\n","   macro avg     0.4709    0.4007    0.4127       301\n","weighted avg     0.5883    0.5880    0.5817       301\n","\n","[[ 0  0  1  0  0  0]\n"," [ 0 19 16  3  0  4]\n"," [ 0  3 54 22  0  7]\n"," [ 0  3 22 76  0 12]\n"," [ 0  1  4  3  1  0]\n"," [ 0  6  7  9  1 27]]\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}],"source":["classification_model2 = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_gabungan_bertahap_classification_6.h5\")\n","pred = classification_model2.predict(contextual_features_concat[test_index])\n","y_pred = encoder_cakapan.inverse_transform(pred)\n","y_true = encoder_cakapan.inverse_transform(y[test_index])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))  "]},{"cell_type":"markdown","metadata":{"id":"g2ttbNGHjZm2"},"source":["##### 4 Kelas Emosi"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wnTUXRMrkWVh"},"outputs":[],"source":["contextual_features_concat_4 = delete_elArr_by_idx(contextual_features_concat, del_idxs)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":111161,"status":"ok","timestamp":1622617252977,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"qIPHtrlqwQ0P","outputId":"77168921-4ae3-4538-8637-a732506a81b6"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/20\n","52/52 [==============================] - 6s 52ms/step - loss: 1.0189 - accuracy: 0.5790 - val_loss: 0.9030 - val_accuracy: 0.6838\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4425 - accuracy: 0.8438 - val_loss: 0.9409 - val_accuracy: 0.6838\n","Epoch 3/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.4007 - accuracy: 0.8711 - val_loss: 0.9968 - val_accuracy: 0.6323\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4241 - accuracy: 0.8611 - val_loss: 0.9158 - val_accuracy: 0.6701\n","10/10 [==============================] - 0s 4ms/step - loss: 0.9030 - accuracy: 0.6838\n","Loss Score :  0.903 Accuracy Score :  0.6838\n","Epoch 1/20\n","52/52 [==============================] - 5s 33ms/step - loss: 1.0254 - accuracy: 0.5749 - val_loss: 0.8633 - val_accuracy: 0.6873\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4774 - accuracy: 0.8460 - val_loss: 0.9110 - val_accuracy: 0.6598\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4057 - accuracy: 0.8650 - val_loss: 0.9418 - val_accuracy: 0.6735\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4435 - accuracy: 0.8487 - val_loss: 0.9225 - val_accuracy: 0.6976\n","Epoch 5/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3572 - accuracy: 0.8771 - val_loss: 0.9277 - val_accuracy: 0.6770\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3827 - accuracy: 0.8621 - val_loss: 0.9325 - val_accuracy: 0.7079\n","Epoch 7/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3795 - accuracy: 0.8598 - val_loss: 0.9581 - val_accuracy: 0.6564\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3473 - accuracy: 0.8751 - val_loss: 0.9613 - val_accuracy: 0.7216\n","Epoch 9/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3639 - accuracy: 0.8699 - val_loss: 0.9291 - val_accuracy: 0.6701\n","Epoch 10/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3447 - accuracy: 0.8765 - val_loss: 0.9627 - val_accuracy: 0.6701\n","Epoch 11/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3499 - accuracy: 0.8780 - val_loss: 0.9723 - val_accuracy: 0.6598\n","10/10 [==============================] - 0s 4ms/step - loss: 0.9613 - accuracy: 0.7216\n","Loss Score :  0.9613 Accuracy Score :  0.7216\n","Epoch 1/20\n","52/52 [==============================] - 6s 33ms/step - loss: 0.9836 - accuracy: 0.5982 - val_loss: 1.0532 - val_accuracy: 0.6426\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4529 - accuracy: 0.8513 - val_loss: 0.9029 - val_accuracy: 0.6701\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4286 - accuracy: 0.8561 - val_loss: 0.9709 - val_accuracy: 0.6632\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3817 - accuracy: 0.8759 - val_loss: 0.9750 - val_accuracy: 0.6838\n","Epoch 5/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4011 - accuracy: 0.8545 - val_loss: 0.9553 - val_accuracy: 0.6873\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3743 - accuracy: 0.8679 - val_loss: 0.9879 - val_accuracy: 0.6598\n","Epoch 7/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3445 - accuracy: 0.8755 - val_loss: 0.8212 - val_accuracy: 0.7079\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3532 - accuracy: 0.8783 - val_loss: 0.9395 - val_accuracy: 0.6804\n","Epoch 9/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3671 - accuracy: 0.8669 - val_loss: 0.9843 - val_accuracy: 0.6804\n","Epoch 10/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3638 - accuracy: 0.8650 - val_loss: 0.9817 - val_accuracy: 0.6976\n","10/10 [==============================] - 0s 4ms/step - loss: 0.8212 - accuracy: 0.7079\n","Loss Score :  0.8212 Accuracy Score :  0.7079\n","Epoch 1/20\n","52/52 [==============================] - 5s 33ms/step - loss: 0.9756 - accuracy: 0.5935 - val_loss: 0.9085 - val_accuracy: 0.6564\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4615 - accuracy: 0.8424 - val_loss: 0.9823 - val_accuracy: 0.6529\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4579 - accuracy: 0.8470 - val_loss: 0.8960 - val_accuracy: 0.6976\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4063 - accuracy: 0.8555 - val_loss: 0.9450 - val_accuracy: 0.6976\n","Epoch 5/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3915 - accuracy: 0.8573 - val_loss: 0.9508 - val_accuracy: 0.6838\n","Epoch 6/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.3581 - accuracy: 0.8851 - val_loss: 0.8463 - val_accuracy: 0.6907\n","10/10 [==============================] - 0s 4ms/step - loss: 0.8960 - accuracy: 0.6976\n","Loss Score :  0.896 Accuracy Score :  0.6976\n","Epoch 1/20\n","52/52 [==============================] - 5s 34ms/step - loss: 0.9926 - accuracy: 0.6093 - val_loss: 1.0363 - val_accuracy: 0.6495\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4596 - accuracy: 0.8499 - val_loss: 1.0181 - val_accuracy: 0.6632\n","Epoch 3/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.4252 - accuracy: 0.8447 - val_loss: 0.9023 - val_accuracy: 0.7010\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4013 - accuracy: 0.8522 - val_loss: 0.9958 - val_accuracy: 0.6564\n","Epoch 5/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.4006 - accuracy: 0.8552 - val_loss: 1.0050 - val_accuracy: 0.6529\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3773 - accuracy: 0.8595 - val_loss: 0.9822 - val_accuracy: 0.6701\n","10/10 [==============================] - 0s 4ms/step - loss: 0.9023 - accuracy: 0.7010\n","Loss Score :  0.9023 Accuracy Score :  0.701\n","Epoch 1/20\n","52/52 [==============================] - 6s 45ms/step - loss: 1.0099 - accuracy: 0.5552 - val_loss: 0.9230 - val_accuracy: 0.6632\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4250 - accuracy: 0.8599 - val_loss: 1.0406 - val_accuracy: 0.6735\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4408 - accuracy: 0.8438 - val_loss: 0.8942 - val_accuracy: 0.6632\n","Epoch 4/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.4003 - accuracy: 0.8535 - val_loss: 0.9770 - val_accuracy: 0.6735\n","Epoch 5/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3867 - accuracy: 0.8699 - val_loss: 0.9258 - val_accuracy: 0.6770\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3563 - accuracy: 0.8827 - val_loss: 0.8674 - val_accuracy: 0.6942\n","Epoch 7/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3900 - accuracy: 0.8468 - val_loss: 0.9699 - val_accuracy: 0.6735\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3786 - accuracy: 0.8592 - val_loss: 1.1008 - val_accuracy: 0.6942\n","Epoch 9/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3761 - accuracy: 0.8636 - val_loss: 0.9940 - val_accuracy: 0.6804\n","10/10 [==============================] - 0s 4ms/step - loss: 0.8674 - accuracy: 0.6942\n","Loss Score :  0.8674 Accuracy Score :  0.6942\n","Epoch 1/20\n","52/52 [==============================] - 5s 34ms/step - loss: 1.0110 - accuracy: 0.6322 - val_loss: 0.9985 - val_accuracy: 0.6392\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.5373 - accuracy: 0.8245 - val_loss: 0.8935 - val_accuracy: 0.6770\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4139 - accuracy: 0.8683 - val_loss: 0.9649 - val_accuracy: 0.6667\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4009 - accuracy: 0.8617 - val_loss: 0.8717 - val_accuracy: 0.6907\n","Epoch 5/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3852 - accuracy: 0.8676 - val_loss: 1.0039 - val_accuracy: 0.6735\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3336 - accuracy: 0.8818 - val_loss: 0.9206 - val_accuracy: 0.7079\n","Epoch 7/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4036 - accuracy: 0.8471 - val_loss: 1.0254 - val_accuracy: 0.6701\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3623 - accuracy: 0.8667 - val_loss: 0.9699 - val_accuracy: 0.6735\n","Epoch 9/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.3244 - accuracy: 0.8923 - val_loss: 1.0590 - val_accuracy: 0.6598\n","10/10 [==============================] - 0s 4ms/step - loss: 0.9206 - accuracy: 0.7079\n","Loss Score :  0.9206 Accuracy Score :  0.7079\n","Epoch 1/20\n","52/52 [==============================] - 6s 50ms/step - loss: 0.9600 - accuracy: 0.6176 - val_loss: 1.0255 - val_accuracy: 0.6460\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4735 - accuracy: 0.8360 - val_loss: 0.8940 - val_accuracy: 0.6667\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4295 - accuracy: 0.8535 - val_loss: 0.9146 - val_accuracy: 0.6667\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4054 - accuracy: 0.8641 - val_loss: 1.0428 - val_accuracy: 0.6735\n","Epoch 5/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3929 - accuracy: 0.8652 - val_loss: 0.9351 - val_accuracy: 0.6495\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3789 - accuracy: 0.8660 - val_loss: 1.0313 - val_accuracy: 0.6564\n","Epoch 7/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3657 - accuracy: 0.8772 - val_loss: 0.9017 - val_accuracy: 0.7079\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3553 - accuracy: 0.8712 - val_loss: 0.8833 - val_accuracy: 0.7113\n","Epoch 9/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3366 - accuracy: 0.8814 - val_loss: 1.0570 - val_accuracy: 0.6735\n","Epoch 10/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3435 - accuracy: 0.8761 - val_loss: 0.9130 - val_accuracy: 0.7113\n","Epoch 11/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3413 - accuracy: 0.8723 - val_loss: 0.9390 - val_accuracy: 0.6770\n","10/10 [==============================] - 0s 4ms/step - loss: 0.8833 - accuracy: 0.7113\n","Loss Score :  0.8833 Accuracy Score :  0.7113\n","Epoch 1/20\n","52/52 [==============================] - 5s 32ms/step - loss: 0.9858 - accuracy: 0.5753 - val_loss: 0.9353 - val_accuracy: 0.6598\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4516 - accuracy: 0.8618 - val_loss: 0.9084 - val_accuracy: 0.6770\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3926 - accuracy: 0.8650 - val_loss: 0.9875 - val_accuracy: 0.6735\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3763 - accuracy: 0.8672 - val_loss: 0.8870 - val_accuracy: 0.6942\n","Epoch 5/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.3840 - accuracy: 0.8640 - val_loss: 0.9805 - val_accuracy: 0.6735\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3685 - accuracy: 0.8700 - val_loss: 0.9121 - val_accuracy: 0.6873\n","Epoch 7/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.3672 - accuracy: 0.8660 - val_loss: 0.9337 - val_accuracy: 0.6976\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3666 - accuracy: 0.8763 - val_loss: 1.1296 - val_accuracy: 0.6701\n","Epoch 9/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3162 - accuracy: 0.8851 - val_loss: 0.9854 - val_accuracy: 0.6735\n","Epoch 10/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3368 - accuracy: 0.8789 - val_loss: 1.0481 - val_accuracy: 0.6529\n","10/10 [==============================] - 0s 4ms/step - loss: 0.9337 - accuracy: 0.6976\n","Loss Score :  0.9337 Accuracy Score :  0.6976\n","Epoch 1/20\n","52/52 [==============================] - 6s 49ms/step - loss: 1.0002 - accuracy: 0.5769 - val_loss: 0.9622 - val_accuracy: 0.6529\n","Epoch 2/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4788 - accuracy: 0.8406 - val_loss: 0.9026 - val_accuracy: 0.6735\n","Epoch 3/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4349 - accuracy: 0.8357 - val_loss: 1.0000 - val_accuracy: 0.6701\n","Epoch 4/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.4330 - accuracy: 0.8539 - val_loss: 0.9343 - val_accuracy: 0.6701\n","Epoch 5/20\n","52/52 [==============================] - 0s 9ms/step - loss: 0.3741 - accuracy: 0.8683 - val_loss: 0.8654 - val_accuracy: 0.6942\n","Epoch 6/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3669 - accuracy: 0.8601 - val_loss: 1.0690 - val_accuracy: 0.6529\n","Epoch 7/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3675 - accuracy: 0.8796 - val_loss: 0.9740 - val_accuracy: 0.6632\n","Epoch 8/20\n","52/52 [==============================] - 0s 8ms/step - loss: 0.3349 - accuracy: 0.8896 - val_loss: 0.8879 - val_accuracy: 0.6804\n","10/10 [==============================] - 0s 4ms/step - loss: 0.8654 - accuracy: 0.6942\n","Loss Score :  0.8654 Accuracy Score :  0.6942\n"]}],"source":["classification_model = run_classification_model(contextual_features_concat_4[train_index_4], y_4[train_index_4], contextual_features_concat_4[test_index_4], y_4[test_index_4], 10)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1329,"status":"ok","timestamp":1622617254296,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"y5zMFeZ8k8Ry","outputId":"00417efc-64cb-46af-af67-8237386e7363"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Marah     0.9143    0.7619    0.8312        42\n","       Sedih     0.7126    0.7209    0.7168        86\n","      Senang     0.7593    0.7257    0.7421       113\n","    Terkejut     0.5574    0.6800    0.6126        50\n","\n","    accuracy                         0.7216       291\n","   macro avg     0.7359    0.7221    0.7257       291\n","weighted avg     0.7332    0.7216    0.7252       291\n","\n","[[32  4  2  4]\n"," [ 1 62 17  6]\n"," [ 1 13 82 17]\n"," [ 1  8  7 34]]\n"]}],"source":["pred = classification_model.predict(contextual_features_concat_4[test_index_4])\n","y_pred = encoder_cakapan_4.inverse_transform(pred)\n","y_true = encoder_cakapan_4.inverse_transform(y_4[test_index_4])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred)) "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fYWZSwl4aN_I"},"outputs":[],"source":["classification_model.save(drive_dir + \"/Eksperimen/Model/model_gabungan_bertahap_classification_4.h5\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2197,"status":"ok","timestamp":1622617355846,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"Ng_bqWkduWqP","outputId":"ad9c0c1d-97fb-4dd1-e251-fdd24763fa16"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Marah     0.9143    0.7619    0.8312        42\n","       Sedih     0.7126    0.7209    0.7168        86\n","      Senang     0.7593    0.7257    0.7421       113\n","    Terkejut     0.5574    0.6800    0.6126        50\n","\n","    accuracy                         0.7216       291\n","   macro avg     0.7359    0.7221    0.7257       291\n","weighted avg     0.7332    0.7216    0.7252       291\n","\n","[[32  4  2  4]\n"," [ 1 62 17  6]\n"," [ 1 13 82 17]\n"," [ 1  8  7 34]]\n"]}],"source":["classification_model2 = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_gabungan_bertahap_classification_4.h5\")\n","pred = classification_model2.predict(contextual_features_concat_4[test_index_4])\n","y_pred = encoder_cakapan_4.inverse_transform(pred)\n","y_true = encoder_cakapan_4.inverse_transform(y_4[test_index_4])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred)) "]},{"cell_type":"markdown","metadata":{"id":"3QHynmkoNd6I"},"source":["#### Concat Contextual Features"]},{"cell_type":"markdown","metadata":{"id":"he8voZccNd6K"},"source":["##### 6 Kelas Emosi"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tGlev1joNd6L"},"outputs":[],"source":["def run_classification_model(X_train, y_train, X_test, y_test, n):\n","  model = None\n","  best_acc = 0\n","  for i in range(n):\n","    model, accuracy_score = train_stratified_random_sampling(X_train, y_train, X_test, y_test, X_train.shape[1:], y_train.shape[1], False)\n","    if best_acc \u003c accuracy_score:\n","      best_acc = accuracy_score\n","      best_model = model\n","  return best_model"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":112489,"status":"ok","timestamp":1622540290477,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"ajVifB41Nd6N","outputId":"279f0cf5-a0a8-4cf7-ca8c-dc9f9008658a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/20\n","54/54 [==============================] - 8s 75ms/step - loss: 1.0283 - accuracy: 0.6294 - val_loss: 1.2261 - val_accuracy: 0.5449\n","Epoch 2/20\n","54/54 [==============================] - 2s 39ms/step - loss: 0.6158 - accuracy: 0.7855 - val_loss: 1.3462 - val_accuracy: 0.5515\n","Epoch 3/20\n","54/54 [==============================] - 2s 41ms/step - loss: 0.6106 - accuracy: 0.7941 - val_loss: 1.2902 - val_accuracy: 0.5482\n","Epoch 4/20\n","54/54 [==============================] - 3s 47ms/step - loss: 0.5599 - accuracy: 0.7937 - val_loss: 1.2971 - val_accuracy: 0.5415\n","Epoch 5/20\n","54/54 [==============================] - 2s 40ms/step - loss: 0.5128 - accuracy: 0.8269 - val_loss: 1.3341 - val_accuracy: 0.5382\n","10/10 [==============================] - 0s 14ms/step - loss: 1.3462 - accuracy: 0.5515\n","Loss Score :  1.3462 Accuracy Score :  0.5515\n","Epoch 1/20\n","54/54 [==============================] - 11s 69ms/step - loss: 1.1243 - accuracy: 0.5507 - val_loss: 1.3184 - val_accuracy: 0.5183\n","Epoch 2/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5758 - accuracy: 0.8079 - val_loss: 1.2571 - val_accuracy: 0.5648\n","Epoch 3/20\n","54/54 [==============================] - 2s 38ms/step - loss: 0.5560 - accuracy: 0.8032 - val_loss: 1.2598 - val_accuracy: 0.5482\n","Epoch 4/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5353 - accuracy: 0.8107 - val_loss: 1.3047 - val_accuracy: 0.5482\n","Epoch 5/20\n","54/54 [==============================] - 2s 38ms/step - loss: 0.5168 - accuracy: 0.8256 - val_loss: 1.2881 - val_accuracy: 0.5648\n","10/10 [==============================] - 0s 13ms/step - loss: 1.2571 - accuracy: 0.5648\n","Loss Score :  1.2571 Accuracy Score :  0.5648\n","Epoch 1/20\n","54/54 [==============================] - 8s 70ms/step - loss: 1.1250 - accuracy: 0.5785 - val_loss: 1.3270 - val_accuracy: 0.5216\n","Epoch 2/20\n","54/54 [==============================] - 2s 38ms/step - loss: 0.5877 - accuracy: 0.8037 - val_loss: 1.3014 - val_accuracy: 0.5515\n","Epoch 3/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5592 - accuracy: 0.8000 - val_loss: 1.1960 - val_accuracy: 0.5581\n","Epoch 4/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5496 - accuracy: 0.8044 - val_loss: 1.2320 - val_accuracy: 0.5449\n","Epoch 5/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5566 - accuracy: 0.8154 - val_loss: 1.3003 - val_accuracy: 0.5581\n","Epoch 6/20\n","54/54 [==============================] - 2s 36ms/step - loss: 0.5262 - accuracy: 0.8239 - val_loss: 1.3688 - val_accuracy: 0.5515\n","10/10 [==============================] - 0s 15ms/step - loss: 1.1960 - accuracy: 0.5581\n","Loss Score :  1.196 Accuracy Score :  0.5581\n","Epoch 1/20\n","54/54 [==============================] - 8s 67ms/step - loss: 1.0569 - accuracy: 0.6130 - val_loss: 1.3167 - val_accuracy: 0.5581\n","Epoch 2/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.6239 - accuracy: 0.7797 - val_loss: 1.5640 - val_accuracy: 0.4751\n","Epoch 3/20\n","54/54 [==============================] - 2s 36ms/step - loss: 0.6668 - accuracy: 0.7623 - val_loss: 1.2300 - val_accuracy: 0.5814\n","Epoch 4/20\n","54/54 [==============================] - 2s 35ms/step - loss: 0.5397 - accuracy: 0.8109 - val_loss: 1.2680 - val_accuracy: 0.5648\n","Epoch 5/20\n","54/54 [==============================] - 2s 38ms/step - loss: 0.5101 - accuracy: 0.8296 - val_loss: 1.2434 - val_accuracy: 0.5449\n","Epoch 6/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5595 - accuracy: 0.8167 - val_loss: 1.3886 - val_accuracy: 0.5548\n","10/10 [==============================] - 0s 14ms/step - loss: 1.2300 - accuracy: 0.5814\n","Loss Score :  1.23 Accuracy Score :  0.5814\n","Epoch 1/20\n","54/54 [==============================] - 9s 91ms/step - loss: 1.0460 - accuracy: 0.6279 - val_loss: 1.4889 - val_accuracy: 0.5382\n","Epoch 2/20\n","54/54 [==============================] - 2s 38ms/step - loss: 0.5671 - accuracy: 0.8109 - val_loss: 1.3696 - val_accuracy: 0.5449\n","Epoch 3/20\n","54/54 [==============================] - 2s 38ms/step - loss: 0.5715 - accuracy: 0.8019 - val_loss: 1.3477 - val_accuracy: 0.5615\n","Epoch 4/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5479 - accuracy: 0.8102 - val_loss: 1.3696 - val_accuracy: 0.5415\n","Epoch 5/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5306 - accuracy: 0.8173 - val_loss: 1.4988 - val_accuracy: 0.5282\n","Epoch 6/20\n","54/54 [==============================] - 2s 37ms/step - loss: 0.5951 - accuracy: 0.7986 - val_loss: 1.2455 - val_accuracy: 0.5615\n","10/10 [==============================] - 0s 16ms/step - loss: 1.3477 - accuracy: 0.5615\n","Loss Score :  1.3477 Accuracy Score :  0.5615\n"]}],"source":["classification_model = run_classification_model(contextual_features_concat_2[train_index], y[train_index], contextual_features_concat_2[test_index], y[test_index], 5)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":55,"status":"ok","timestamp":1622540290479,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"-jUZq8O5Nd6P","outputId":"3f331db0-0f2a-40a8-cdaa-1ef551a08425"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Jijik     0.0000    0.0000    0.0000         1\n","       Marah     0.6296    0.4048    0.4928        42\n","       Sedih     0.4872    0.6628    0.5616        86\n","      Senang     0.6852    0.6549    0.6697       113\n","       Takut     0.0000    0.0000    0.0000         9\n","    Terkejut     0.5510    0.5400    0.5455        50\n","\n","    accuracy                         0.5814       301\n","   macro avg     0.3922    0.3771    0.3782       301\n","weighted avg     0.5758    0.5814    0.5712       301\n","\n","[[ 0  0  1  0  0  0]\n"," [ 0 17 17  3  0  5]\n"," [ 0  4 57 18  0  7]\n"," [ 0  2 28 74  0  9]\n"," [ 0  1  4  3  0  1]\n"," [ 0  3 10 10  0 27]]\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}],"source":["pred = classification_model.predict(contextual_features_concat_2[test_index])\n","y_pred = encoder_cakapan.inverse_transform(pred)\n","y_true = encoder_cakapan.inverse_transform(y[test_index])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred)) "]},{"cell_type":"markdown","metadata":{"id":"HiZ6wXLqNd6S"},"source":["##### 4 Kelas Emosi"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sTV5HC7GNd6S"},"outputs":[],"source":["contextual_features_concat_2_4 = delete_elArr_by_idx(contextual_features_concat_2, del_idxs)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":120703,"status":"ok","timestamp":1622541354630,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"WIHUi8ygNd6T","outputId":"9f5a1802-1194-4db9-8330-463f4a71ed69"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/20\n","52/52 [==============================] - 9s 98ms/step - loss: 0.8696 - accuracy: 0.6446 - val_loss: 0.8053 - val_accuracy: 0.6942\n","Epoch 2/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5110 - accuracy: 0.8145 - val_loss: 0.8746 - val_accuracy: 0.6770\n","Epoch 3/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5136 - accuracy: 0.8102 - val_loss: 0.8565 - val_accuracy: 0.6873\n","Epoch 4/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5201 - accuracy: 0.8153 - val_loss: 0.8265 - val_accuracy: 0.6976\n","Epoch 5/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.4597 - accuracy: 0.8298 - val_loss: 0.8805 - val_accuracy: 0.6838\n","Epoch 6/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.4832 - accuracy: 0.8149 - val_loss: 0.8631 - val_accuracy: 0.6942\n","Epoch 7/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.4972 - accuracy: 0.8216 - val_loss: 0.8802 - val_accuracy: 0.6873\n","10/10 [==============================] - 0s 13ms/step - loss: 0.8265 - accuracy: 0.6976\n","Loss Score :  0.8265 Accuracy Score :  0.6976\n","Epoch 1/20\n","52/52 [==============================] - 8s 69ms/step - loss: 0.8798 - accuracy: 0.6782 - val_loss: 0.8247 - val_accuracy: 0.6873\n","Epoch 2/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5180 - accuracy: 0.8082 - val_loss: 0.9104 - val_accuracy: 0.6770\n","Epoch 3/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5147 - accuracy: 0.8166 - val_loss: 0.8275 - val_accuracy: 0.7079\n","Epoch 4/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.4689 - accuracy: 0.8262 - val_loss: 0.8761 - val_accuracy: 0.6907\n","Epoch 5/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.4879 - accuracy: 0.8237 - val_loss: 0.8486 - val_accuracy: 0.6907\n","Epoch 6/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.4585 - accuracy: 0.8272 - val_loss: 0.8893 - val_accuracy: 0.6770\n","10/10 [==============================] - 0s 13ms/step - loss: 0.8275 - accuracy: 0.7079\n","Loss Score :  0.8275 Accuracy Score :  0.7079\n","Epoch 1/20\n","52/52 [==============================] - 9s 68ms/step - loss: 0.8659 - accuracy: 0.6411 - val_loss: 0.8239 - val_accuracy: 0.6907\n","Epoch 2/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.5631 - accuracy: 0.7982 - val_loss: 0.8350 - val_accuracy: 0.7010\n","Epoch 3/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.4824 - accuracy: 0.8263 - val_loss: 0.9063 - val_accuracy: 0.6907\n","Epoch 4/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.5406 - accuracy: 0.8137 - val_loss: 0.8612 - val_accuracy: 0.6873\n","Epoch 5/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.5263 - accuracy: 0.8134 - val_loss: 0.8884 - val_accuracy: 0.7010\n","10/10 [==============================] - 0s 14ms/step - loss: 0.8350 - accuracy: 0.7010\n","Loss Score :  0.835 Accuracy Score :  0.701\n","Epoch 1/20\n","52/52 [==============================] - 8s 66ms/step - loss: 0.9122 - accuracy: 0.6433 - val_loss: 0.8563 - val_accuracy: 0.6701\n","Epoch 2/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.5757 - accuracy: 0.7861 - val_loss: 0.9482 - val_accuracy: 0.6701\n","Epoch 3/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.5484 - accuracy: 0.7986 - val_loss: 0.8448 - val_accuracy: 0.7010\n","Epoch 4/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.4773 - accuracy: 0.8284 - val_loss: 0.8379 - val_accuracy: 0.6873\n","Epoch 5/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.4687 - accuracy: 0.8329 - val_loss: 0.8406 - val_accuracy: 0.6873\n","Epoch 6/20\n","52/52 [==============================] - 2s 38ms/step - loss: 0.4473 - accuracy: 0.8365 - val_loss: 0.9543 - val_accuracy: 0.6632\n","10/10 [==============================] - 0s 12ms/step - loss: 0.8448 - accuracy: 0.7010\n","Loss Score :  0.8448 Accuracy Score :  0.701\n","Epoch 1/20\n","52/52 [==============================] - 9s 67ms/step - loss: 0.8880 - accuracy: 0.6443 - val_loss: 0.8813 - val_accuracy: 0.6907\n","Epoch 2/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5176 - accuracy: 0.8155 - val_loss: 0.8669 - val_accuracy: 0.6735\n","Epoch 3/20\n","52/52 [==============================] - 2s 37ms/step - loss: 0.5657 - accuracy: 0.7894 - val_loss: 0.8691 - val_accuracy: 0.6907\n","Epoch 4/20\n","52/52 [==============================] - 2s 36ms/step - loss: 0.4837 - accuracy: 0.8172 - val_loss: 1.0129 - val_accuracy: 0.6632\n","10/10 [==============================] - 0s 13ms/step - loss: 0.8813 - accuracy: 0.6907\n","Loss Score :  0.8813 Accuracy Score :  0.6907\n"]}],"source":["classification_model = run_classification_model(contextual_features_concat_2_4[train_index_4], y_4[train_index_4], contextual_features_concat_2_4[test_index_4], y_4[test_index_4], 5)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2877,"status":"ok","timestamp":1622541357294,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"WQ2siqorNd6T","outputId":"0f2816af-be32-45e8-9565-59cc6f539626"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Marah     0.8108    0.7143    0.7595        42\n","       Sedih     0.7286    0.5930    0.6538        86\n","      Senang     0.6917    0.8142    0.7480       113\n","    Terkejut     0.6471    0.6600    0.6535        50\n","\n","    accuracy                         0.7079       291\n","   macro avg     0.7195    0.6954    0.7037       291\n","weighted avg     0.7121    0.7079    0.7056       291\n","\n","[[30  5  3  4]\n"," [ 4 51 26  5]\n"," [ 2 10 92  9]\n"," [ 1  4 12 33]]\n"]}],"source":["pred = classification_model.predict(contextual_features_concat_2_4[test_index_4])\n","y_pred = encoder_cakapan_4.inverse_transform(pred)\n","y_true = encoder_cakapan_4.inverse_transform(y_4[test_index_4])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred)) "]},{"cell_type":"markdown","metadata":{"id":"Jb8HljFHh4D8"},"source":["## 2. Model Gabungan Level Keputusan"]},{"cell_type":"markdown","metadata":{"id":"SgUn3ih6_lJy"},"source":["### Contextual Model"]},{"cell_type":"code","execution_count":26,"metadata":{"executionInfo":{"elapsed":8483,"status":"ok","timestamp":1622634495588,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"Bo23WqyGk1HS"},"outputs":[],"source":["model_akustik_contextual = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_akustik_bertahap_contextual.h5\")\n","model_leksikal_contextual = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_leksikal_bertahap_contextual.h5\")"]},{"cell_type":"code","execution_count":27,"metadata":{"executionInfo":{"elapsed":33,"status":"ok","timestamp":1622634495591,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"sXT4FvPclnB0"},"outputs":[],"source":["def extract_contextual_features(model, idx_output, data):\n","  get_relu_output = backend.function([model.layers[0].input], [model.layers[idx_output].output])\n","  relu_output = get_relu_output([data])\n","  return np.array(relu_output[0])"]},{"cell_type":"code","execution_count":28,"metadata":{"executionInfo":{"elapsed":5046,"status":"ok","timestamp":1622634500611,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"9lRPJbQWlBam"},"outputs":[],"source":["contextual_feature_akustik = extract_contextual_features(model_akustik_contextual, 3, X_akustik)\n","contextual_feature_leksikal = extract_contextual_features(model_leksikal_contextual, 3, X_leksikal)"]},{"cell_type":"markdown","metadata":{"id":"PQw6udNCAUyF"},"source":["### 6 Kelas"]},{"cell_type":"markdown","metadata":{"id":"D96iwwZOoEaB"},"source":["#### Load Model"]},{"cell_type":"code","execution_count":29,"metadata":{"executionInfo":{"elapsed":2943,"status":"ok","timestamp":1622634503544,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"sLYMfx-aRiqu"},"outputs":[],"source":["model_akustik_classification = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_akustik_bertahap_classification_6.h5\")\n","model_leksikal_classification = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_leksikal_bertahap_classification_6.h5\")"]},{"cell_type":"markdown","metadata":{"id":"8frCZRMkoUxC"},"source":["#### Evaluation Model"]},{"cell_type":"code","execution_count":43,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":17},"executionInfo":{"elapsed":307,"status":"ok","timestamp":1622635115360,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"3x8_KFvMkkUF"},"outputs":[{"data":{"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "],"text/plain":["\u003cIPython.core.display.Javascript object\u003e"]},"metadata":{},"output_type":"display_data"},{"data":{"application/javascript":["download(\"download_92a0bebc-0d22-493f-b380-18f3b5a2a7ef\", \"contextual_feature_akustik_4.pkl\", 14868700)"],"text/plain":["\u003cIPython.core.display.Javascript object\u003e"]},"metadata":{},"output_type":"display_data"}],"source":["joblib.dump(contextual_feature_akustik_4, \"contextual_feature_akustik.pkl\")\n","files.download(\"contextual_feature_akustik.pkl\")"]},{"cell_type":"code","execution_count":30,"metadata":{"executionInfo":{"elapsed":2133,"status":"ok","timestamp":1622634505660,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"Ui04ytANS1WS"},"outputs":[],"source":["pred_akustik = model_akustik_classification.predict(contextual_feature_akustik[test_index])\n","pred_leksikal = model_leksikal_classification.predict(contextual_feature_leksikal[test_index])"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":42,"status":"ok","timestamp":1622634505661,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"gD-NPt5SNB-A","outputId":"795c8ed4-8ed8-4712-f482-2da050883b12"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Jijik     0.0000    0.0000    0.0000         1\n","       Marah     0.4000    0.4286    0.4138        42\n","       Sedih     0.3974    0.3605    0.3780        86\n","      Senang     0.4476    0.5664    0.5000       113\n","       Takut     0.0000    0.0000    0.0000         9\n","    Terkejut     0.4571    0.3200    0.3765        50\n","\n","    accuracy                         0.4286       301\n","   macro avg     0.2837    0.2792    0.2781       301\n","weighted avg     0.4133    0.4286    0.4160       301\n","\n","[[ 0  0  0  0  0  1]\n"," [ 0 18  9 11  0  4]\n"," [ 0  9 31 43  0  3]\n"," [ 0 11 27 64  0 11]\n"," [ 0  1  2  6  0  0]\n"," [ 0  6  9 19  0 16]]\n","              precision    recall  f1-score   support\n","\n","       Jijik     0.0000    0.0000    0.0000         1\n","       Marah     0.5667    0.4048    0.4722        42\n","       Sedih     0.4907    0.6163    0.5464        86\n","      Senang     0.6525    0.6814    0.6667       113\n","       Takut     0.0000    0.0000    0.0000         9\n","    Terkejut     0.5556    0.5000    0.5263        50\n","\n","    accuracy                         0.5714       301\n","   macro avg     0.3776    0.3671    0.3686       301\n","weighted avg     0.5565    0.5714    0.5597       301\n","\n","[[ 0  0  1  0  0  0]\n"," [ 0 17 18  3  0  4]\n"," [ 0  6 53 21  0  6]\n"," [ 0  2 25 77  0  9]\n"," [ 0  1  4  3  0  1]\n"," [ 0  4  7 14  0 25]]\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}],"source":["y_pred = encoder_cakapan.inverse_transform(pred_akustik)\n","y_true = encoder_cakapan.inverse_transform(y[test_index])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))\n","\n","y_pred = encoder_cakapan.inverse_transform(pred_leksikal)\n","y_true = encoder_cakapan.inverse_transform(y[test_index])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))"]},{"cell_type":"code","execution_count":32,"metadata":{"executionInfo":{"elapsed":39,"status":"ok","timestamp":1622634505662,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"Oo-WZz6tV-81"},"outputs":[],"source":["pred_gabungan_keputusan = []\n","for i in range(len(pred_akustik)):\n","  if (pred_akustik[i].max() \u003e pred_leksikal[i].max()):\n","    pred_gabungan_keputusan.append(pred_akustik[i])\n","  else :\n","    pred_gabungan_keputusan.append(pred_leksikal[i])\n","pred_gabungan_keputusan = np.array(pred_gabungan_keputusan)"]},{"cell_type":"code","execution_count":33,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":39,"status":"ok","timestamp":1622634505663,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"KxOMEFgcW4Lf","outputId":"a4a1ed3c-be51-4cd1-ec5f-9ee56fe96650"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Jijik     0.0000    0.0000    0.0000         1\n","       Marah     0.5758    0.4524    0.5067        42\n","       Sedih     0.4811    0.5930    0.5313        86\n","      Senang     0.6387    0.6726    0.6552       113\n","       Takut     0.0000    0.0000    0.0000         9\n","    Terkejut     0.5814    0.5000    0.5376        50\n","\n","    accuracy                         0.5681       301\n","   macro avg     0.3795    0.3697    0.3718       301\n","weighted avg     0.5541    0.5681    0.5578       301\n","\n","[[ 0  0  1  0  0  0]\n"," [ 0 19 18  3  0  2]\n"," [ 0  6 51 23  0  6]\n"," [ 0  2 26 76  0  9]\n"," [ 0  1  4  3  0  1]\n"," [ 0  5  6 14  0 25]]\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]}],"source":["y_pred = encoder_cakapan.inverse_transform(pred_gabungan_keputusan)\n","y_true = encoder_cakapan.inverse_transform(y[test_index])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))"]},{"cell_type":"markdown","metadata":{"id":"reVMOMK6AYWz"},"source":["### 4 Kelas"]},{"cell_type":"markdown","metadata":{"id":"OxL25CrZAYW0"},"source":["#### Load Model"]},{"cell_type":"code","execution_count":34,"metadata":{"executionInfo":{"elapsed":2704,"status":"ok","timestamp":1622634518870,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"ltOBdo3UAYW1"},"outputs":[],"source":["model_akustik_classification_4 = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_akustik_bertahap_classification_4.h5\")\n","model_leksikal_classification_4 = keras.models.load_model(drive_dir + \"/Eksperimen/Model/model_leksikal_bertahap_classification_4.h5\")"]},{"cell_type":"markdown","metadata":{"id":"2BcPkK8vAYW2"},"source":["#### Evaluation Model"]},{"cell_type":"code","execution_count":35,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1622634519386,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"BGFDrFBt_8WL"},"outputs":[],"source":["contextual_feature_akustik_4 = delete_elArr_by_idx(contextual_feature_akustik, del_idxs)\n","contextual_feature_leksikal_4 = delete_elArr_by_idx(contextual_feature_leksikal, del_idxs)"]},{"cell_type":"code","execution_count":40,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":259,"status":"ok","timestamp":1622634590698,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"DfxKUHyzjurR","outputId":"837adb61-dc93-466b-9061-a98efaad21d0"},"outputs":[{"data":{"text/plain":["array([[[0.        , 0.        , 0.        , ..., 0.4882357 ,\n","         0.        , 0.48818326],\n","        [0.        , 0.        , 0.        , ..., 0.4979253 ,\n","         0.        , 0.4194304 ],\n","        [0.        , 0.        , 0.        , ..., 0.6360004 ,\n","         0.        , 0.528561  ],\n","        ...,\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844]],\n","\n","       [[0.        , 0.        , 0.        , ..., 0.53225935,\n","         0.        , 0.49748313],\n","        [0.        , 0.        , 0.        , ..., 0.6731963 ,\n","         0.        , 0.5206923 ],\n","        [0.        , 0.        , 0.        , ..., 0.5829079 ,\n","         0.        , 0.44584435],\n","        ...,\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844]],\n","\n","       [[0.        , 0.        , 0.        , ..., 0.4976887 ,\n","         0.        , 0.4655105 ],\n","        [0.        , 0.        , 0.        , ..., 0.64114   ,\n","         0.        , 0.55844045],\n","        [0.        , 0.        , 0.        , ..., 0.71679807,\n","         0.        , 0.5421691 ],\n","        ...,\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844]],\n","\n","       ...,\n","\n","       [[0.        , 0.        , 0.        , ..., 0.30492935,\n","         0.        , 0.30584973],\n","        [0.        , 0.        , 0.        , ..., 0.52651   ,\n","         0.        , 0.3948332 ],\n","        [0.        , 0.        , 0.        , ..., 0.5797485 ,\n","         0.        , 0.41338325],\n","        ...,\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844]],\n","\n","       [[0.        , 0.        , 0.        , ..., 0.4981026 ,\n","         0.        , 0.48513627],\n","        [0.        , 0.        , 0.        , ..., 0.7130233 ,\n","         0.        , 0.58789855],\n","        [0.        , 0.        , 0.        , ..., 0.7021818 ,\n","         0.        , 0.5347504 ],\n","        ...,\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844]],\n","\n","       [[0.        , 0.        , 0.        , ..., 0.60585904,\n","         0.        , 0.5779284 ],\n","        [0.        , 0.        , 0.        , ..., 0.6850594 ,\n","         0.        , 0.5358126 ],\n","        [0.        , 0.        , 0.        , ..., 0.7810782 ,\n","         0.        , 0.5974326 ],\n","        ...,\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844],\n","        [0.        , 0.        , 0.        , ..., 0.03835657,\n","         0.        , 0.03616844]]], dtype=float32)"]},"execution_count":40,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["contextual_feature_akustik_4"]},{"cell_type":"code","execution_count":36,"metadata":{"executionInfo":{"elapsed":2921,"status":"ok","timestamp":1622634522713,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"UosCV3gIAYW3"},"outputs":[],"source":["pred_akustik_4 = model_akustik_classification_4.predict(contextual_feature_akustik_4[test_index_4])\n","pred_leksikal_4 = model_leksikal_classification_4.predict(contextual_feature_leksikal_4[test_index_4])"]},{"cell_type":"code","execution_count":39,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":431,"status":"ok","timestamp":1622634578191,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgXbP9EsEFyjEw2upmLIxrmTNaf9y_R5vn6mAI=s64","userId":"17040944261982105960"},"user_tz":-420},"id":"z-d0wfyujjIX","outputId":"a4c53023-c0f9-4586-c64f-680b6cf03b24"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Marah     0.4667    0.3333    0.3889        42\n","       Sedih     0.4409    0.4767    0.4581        86\n","      Senang     0.4552    0.5841    0.5116       113\n","    Terkejut     0.4348    0.2000    0.2740        50\n","\n","    accuracy                         0.4502       291\n","   macro avg     0.4494    0.3985    0.4081       291\n","weighted avg     0.4491    0.4502    0.4373       291\n","\n","[[14 11 15  2]\n"," [ 6 41 37  2]\n"," [ 7 31 66  9]\n"," [ 3 10 27 10]]\n","              precision    recall  f1-score   support\n","\n","       Marah     0.6735    0.7857    0.7253        42\n","       Sedih     0.6914    0.6512    0.6707        86\n","      Senang     0.7120    0.7876    0.7479       113\n","    Terkejut     0.6667    0.4800    0.5581        50\n","\n","    accuracy                         0.6942       291\n","   macro avg     0.6859    0.6761    0.6755       291\n","weighted avg     0.6925    0.6942    0.6892       291\n","\n","[[33  5  2  2]\n"," [ 7 56 20  3]\n"," [ 5 12 89  7]\n"," [ 4  8 14 24]]\n"]}],"source":["y_pred = encoder_cakapan_4.inverse_transform(pred_akustik_4)\n","y_true = encoder_cakapan_4.inverse_transform(y_4[test_index_4])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))\n","\n","y_pred = encoder_cakapan_4.inverse_transform(pred_leksikal_4)\n","y_true = encoder_cakapan_4.inverse_transform(y_4[test_index_4])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fw-LfQwwAYW4"},"outputs":[],"source":["pred_gabungan_4 = []\n","for i in range(len(pred_akustik_4)):\n","  if (pred_akustik_4[i].max() \u003e pred_leksikal_4[i].max()):\n","    print(\"Akustik\", pred_akustik_4[i].max(), pred_leksikal_4[i].max())\n","    pred_gabungan_4.append(pred_akustik_4[i])\n","  else :\n","    print(\"Leksikal\", pred_akustik_4[i].max(), pred_leksikal_4[i].max())\n","    pred_gabungan_4.append(pred_leksikal_4[i])\n","pred_gabungan_4 = np.array(pred_gabungan_4)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1622616078674,"user":{"displayName":"Aisyah Nurul","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gjj6dYOzyu8rAEVxrWrd1lhXiCJ655GAucTSnZ0Mg=s64","userId":"00645320285832870952"},"user_tz":-420},"id":"QTpdnp18AYW4","outputId":"ca3296a1-5fb1-4f2f-f5c2-8d34d3ba295b"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       Marah     0.7083    0.8095    0.7556        42\n","       Sedih     0.6962    0.6395    0.6667        86\n","      Senang     0.6977    0.7965    0.7438       113\n","    Terkejut     0.6857    0.4800    0.5647        50\n","\n","    accuracy                         0.6976       291\n","   macro avg     0.6970    0.6814    0.6827       291\n","weighted avg     0.6967    0.6976    0.6919       291\n","\n","[[34  5  1  2]\n"," [ 6 55 23  2]\n"," [ 4 12 90  7]\n"," [ 4  7 15 24]]\n"]}],"source":["y_pred = encoder_cakapan_4.inverse_transform(pred_gabungan_4)\n","y_true = encoder_cakapan_4.inverse_transform(y_4[test_index_4])\n","print(classification_report(y_true, y_pred, digits=4))\n","print(confusion_matrix(y_true, y_pred))"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":["WHO9uPMk65Yz","S2OerLT9mfrB","zbtGKWA6gi8q","QjAS_5MU_2y9","uUDafrfVKwNx","SIFvY96Cnvym","SFQD1ZH4muw_","hstlRu2cKB10","Jb8HljFHh4D8","PQw6udNCAUyF"],"name":"Model Gabungan Bertahap.ipynb ","version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}